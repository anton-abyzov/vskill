# ==================================================
# Kafka Broker Configuration - Production Template
# ==================================================

# Broker ID (unique per broker, 0-based)
broker.id=0

# ==================================================
# Listeners & Advertised Listeners
# ==================================================

# Internal listener (broker-to-broker replication)
listeners=INTERNAL://0.0.0.0:9092,EXTERNAL://0.0.0.0:9093

# Advertised listeners (clients connect here)
advertised.listeners=INTERNAL://kafka-0.kafka.svc.cluster.local:9092,EXTERNAL://kafka-0.example.com:9093

# Listener security protocol map
listener.security.protocol.map=INTERNAL:SASL_SSL,EXTERNAL:SASL_SSL

# Inter-broker listener name
inter.broker.listener.name=INTERNAL

# ==================================================
# Data Directories
# ==================================================

# Log directories (comma-separated for multiple disks, RAID 0)
log.dirs=/data/kafka-logs-0,/data/kafka-logs-1,/data/kafka-logs-2

# ==================================================
# Replication
# ==================================================

# Default replication factor for auto-created topics
default.replication.factor=3

# Minimum in-sync replicas (should be RF - 1)
min.insync.replicas=2

# Offsets topic replication factor
offsets.topic.replication.factor=3

# Transaction state log replication factor
transaction.state.log.replication.factor=3
transaction.state.log.min.isr=2

# Unclean leader election (NEVER enable in production!)
unclean.leader.election.enable=false

# ==================================================
# Log Retention & Cleanup
# ==================================================

# Retention time (168 hours = 7 days)
log.retention.hours=168

# Retention size per partition (optional, -1 = no limit)
log.retention.bytes=-1

# Log segment size (1 GB)
log.segment.bytes=1073741824

# Retention check interval (5 minutes)
log.retention.check.interval.ms=300000

# Log cleanup policy (delete or compact)
log.cleanup.policy=delete

# ==================================================
# Topic Management
# ==================================================

# Auto-create topics (DISABLE for production!)
auto.create.topics.enable=false

# Allow topic deletion
delete.topic.enable=true

# Default number of partitions for auto-created topics
num.partitions=12

# ==================================================
# Performance Tuning
# ==================================================

# Network threads (handle client connections)
num.network.threads=8

# I/O threads (disk operations, set to 2x number of disks)
num.io.threads=16

# Socket buffer sizes
socket.send.buffer.bytes=1048576
socket.receive.buffer.bytes=1048576
socket.request.max.bytes=104857600

# Replica fetcher threads
num.replica.fetchers=4

# Background threads
background.threads=10

# ==================================================
# Compression
# ==================================================

# Broker-side compression (producer setting takes precedence)
compression.type=lz4

# ==================================================
# Message Size Limits
# ==================================================

# Maximum message size (1 MB)
message.max.bytes=1048576

# Replica fetch max bytes (should be >= message.max.bytes)
replica.fetch.max.bytes=1048576

# ==================================================
# Group Coordinator
# ==================================================

# Group coordinator protocols
group.coordinator.rebalance.protocols=classic,cooperative

# Number of group coordinator threads
group.coordinator.num.threads=4

# ==================================================
# SSL/TLS Configuration
# ==================================================

# SSL keystore location
ssl.keystore.location=/etc/kafka/secrets/kafka.keystore.jks
ssl.keystore.password=changeme
ssl.key.password=changeme

# SSL truststore location
ssl.truststore.location=/etc/kafka/secrets/kafka.truststore.jks
ssl.truststore.password=changeme

# Client authentication (required, requested, none)
ssl.client.auth=required

# Enabled protocols
ssl.enabled.protocols=TLSv1.2,TLSv1.3

# Cipher suites (optional, defaults are secure)
# ssl.cipher.suites=

# ==================================================
# SASL Configuration
# ==================================================

# SASL enabled mechanisms
sasl.enabled.mechanisms=SCRAM-SHA-512

# SASL mechanism for inter-broker communication
sasl.mechanism.inter.broker.protocol=SCRAM-SHA-512

# SASL JAAS configuration
# sasl.jaas.config=...

# ==================================================
# ZooKeeper Configuration (if not using KRaft)
# ==================================================

# ZooKeeper connection string (comma-separated)
# zookeeper.connect=zk-0.zk.svc.cluster.local:2181,zk-1.zk.svc.cluster.local:2181,zk-2.zk.svc.cluster.local:2181

# ZooKeeper session timeout
# zookeeper.session.timeout.ms=18000

# ZooKeeper connection timeout
# zookeeper.connection.timeout.ms=18000

# ==================================================
# Metrics & Monitoring
# ==================================================

# Metrics reporters (Prometheus JMX Exporter via Java agent)
metric.reporters=

# Metrics collection interval
metrics.sample.window.ms=30000
metrics.num.samples=2

# ==================================================
# Quotas (Optional)
# ==================================================

# Producer quota (bytes/sec per client ID)
# quota.producer.default=10485760

# Consumer quota (bytes/sec per client ID)
# quota.consumer.default=20971520

# ==================================================
# Controller Configuration
# ==================================================

# Controller socket timeout
controller.socket.timeout.ms=30000

# ==================================================
# Replica Management
# ==================================================

# Replica lag time max (10 seconds)
replica.lag.time.max.ms=10000

# Replica socket timeout
replica.socket.timeout.ms=30000

# Replica socket receive buffer
replica.socket.receive.buffer.bytes=65536

# ==================================================
# Leader Balancing
# ==================================================

# Auto leader rebalancing (careful with this!)
auto.leader.rebalance.enable=true

# Leader imbalance check interval (5 minutes)
leader.imbalance.check.interval.seconds=300

# Leader imbalance per broker percentage
leader.imbalance.per.broker.percentage=10

# ==================================================
# Log Flush (let OS handle flushing for performance)
# ==================================================

# Log flush interval messages (optional, -1 = OS handles)
log.flush.interval.messages=10000

# Log flush interval ms (optional, -1 = OS handles)
log.flush.interval.ms=1000

# ==================================================
# Miscellaneous
# ==================================================

# Controlled shutdown enable
controlled.shutdown.enable=true

# Controlled shutdown max retries
controlled.shutdown.max.retries=3

# Controlled shutdown retry backoff
controlled.shutdown.retry.backoff.ms=5000
